 <!DOCTYPE html>
 <html lang="da">
 <head>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <!-- The above 3 meta tags *must* come first in the head;
      any other head content must come *after* these tags -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Alegreya&family=Alegreya+Sans&family=Merriweather&family=Merriweather+Sans&family=Nunito&family=Nunito+Sans&family=Quattrocento&family=Quattrocento+Sans&family=Roboto&family=Roboto+Mono&family=Roboto+Slab&display=swap" rel="stylesheet">
 <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Crimson+Pro:regular,bold,italic">
 <link rel="stylesheet" type="text/css" media="all" href="stylesheet.css">
 <script >
      MathJax = { tex:       {packages:    {'[+]': ['physics' ]},
                              inlineMath:  [ ['$','$'],   ["\\(","\\)"] ],
                              displayMath: [ ['$$','$$'], ["\\[","\\]"] ]},
                  svg:       {scale: 1},
                  loader:    {load: ['[tex]/physics' ]},
                  styles:    {".MathJax_SVG_Display":
                                 { "text-align":       "center",
                                   "margin":           "0.25em 0em ! important"}}
                };
   </script>
<script>
function toggleElement(id) {
  var x = document.getElementById(id);
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
function toggleTwoElements(id1, id2) {
  toggleElement(id1);
  toggleElement(id2);
}
</script>
   <title>(The Metapict Blog)</title>
 </head>
 <body>
<div style="display: flex; height: 100vh;">
   <div id="sidemenu">
     <div class="sidemenu"><span class="topnavigation"><a href="metapict-examples.rkt-section-7.html">‚Üê Prev</a><a href="metapict-examples.rkt-book-1.html">Up</a><a href="metapict-examples.rkt-the-index-table-9.html">Next ‚Üí</a></span><div class="sidemenutoc"><nav id="toc"><div id="toggleid14a" class="toc_header"><div style="display: inline;"><div><a onclick="toggleTwoElements('toggleid14a','toggleid14b')">‚ñº</a><a href="metapict-examples.rkt-book-1.html">The Metapict Blog</a></div></div>
<div class="sidemenu_vertical_line"><ol class="toc" role="directory"><li class="toc_entry"><a href="metapict-examples.rkt-section-2.html#1"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">1</span>
<span class="toc_section">Introduction</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-3.html#2"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">2</span>
<span class="toc_section">Arrows</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-4.html#3"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">3</span>
<span class="toc_section">Regular polygons</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-5.html#4"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">4</span>
<span class="toc_section">Venn Diagrams</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-6.html#5"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">5</span>
<span class="toc_section">Simple Block Diagrams - Passes in Racket</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-7.html#6"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">6</span>
<span class="toc_section">Clock</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-8.html#7"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">7</span>
<span class="toc_section">Convex Hull</span></div></a></li></ol>
<a href="metapict-examples.rkt-the-index-table-9.html#index"><span class="toc_title">Index</span></a></div></div>
<div id="toggleid14b" class="toc_header"><div style="display: none;"><div><a onclick="toggleTwoElements('toggleid14a','toggleid14b')">‚ñ∂<a href="metapict-examples.rkt-book-1.html">The Metapict Blog</a></a></div></div></div></nav><b>THIS PAGE</b><nav id="toc"><div id="toggleid15a" class="toc_header"><div style="display: inline;"><div><a onclick="toggleTwoElements('toggleid15a','toggleid15b')">‚ñº</a><a href="metapict-examples.rkt-section-8.html#7"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">7</span>
<span class="toc_section">Convex Hull</span></div></a></div></div>
<div class="sidemenu_vertical_line"><ol class="toc" role="directory"><li class="toc_entry"><a href="metapict-examples.rkt-section-8.html#7.1"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">7.1</span>
<span class="toc_subsection">Convex Hull - A first algorithm</span></div></a></li><li class="toc_entry"><a href="metapict-examples.rkt-section-8.html#7.2"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">7.2</span>
<span class="toc_subsection">Convex Hull - An incremental algorithm</span></div></a></li></ol>
</div></div>
<div id="toggleid15b" class="toc_header"><div style="display: none;"><div><a onclick="toggleTwoElements('toggleid15a','toggleid15b')">‚ñ∂<a href="metapict-examples.rkt-section-8.html#7"><div style="display: flex; justify-content: flex-start;"><span class="toc_numbering" style="flex-shrink: 0; flex-grow: 0;">7</span>
<span class="toc_section">Convex Hull</span></div></a></a></div></div></div></nav></div></div>
   </div>
   <div id="doc" class="multi">
     <a name="7"></a><div class="section">7.  Convex Hull</div><div class="paragraph"></div><a name="7.1"></a><div class="subsection">7.1  Convex Hull - A first algorithm</div><div class="paragraph">In this section, we will tackle the problem of computing the convex hull of a set
of points <span class="math">\(ùïä=\{P_1,P_2,\ldots,P_n\}\)</span>. Imagine the points as nails. If you stretch
a rubber band around the nails, the rubber band will contract and assume the shape
 of the convex hull.</div><div class="paragraph"><span class="centered"><span class="figure_center"><a name="figure1"></a>
<span class="svgobj"><object style="vertical-align: 0px; margin: -3px -3px -3px -3px;" data="0-pict.svg" type="image/svg+xml"></object></span> <br />
<span class="figcaption"></span></span></span>
<span class="sidenote">In a convex set, the line segment between any two points is entirely within the set.
A convex set doesn&rsquo;t have any ‚Äúindentations‚Äù.</span>
Intuitively we are looking for the smallest, convex polygon that encloses the points.

For now, we will ignore special cases such as the case where all points lie on the
same line (in which case the convex hull becomes a line segment).</div><div class="paragraph">Without the nails our initial example looks like this:
<span class="centered"><span class="figure_center"><a name="figure2"></a>
<span class="svgobj"><object style="vertical-align: 0px; margin: -3px -3px -3px -3px;" data="1-pict.svg" type="image/svg+xml"></object></span> <br />
<span class="figcaption"></span></span></span>

The output of a convex hull algorithm is a polygon.
We will represent a polygon as a list of points in clockwise order.</div><div class="paragraph" style="clear: both;">There are several algorithms that compute the convex hull, but let&rsquo;s begin with the simplest.
It builds on a simple observation:

<span class="sidenote">We are going in the clockwise direction around the polygon, so the other
points lie to the left. Had we used the counter clockwise direction,
the other points would lie to the right.</span></div><div class="paragraph  framed">The line segment between two points <span class="math">\(P\)</span> and <span class="math">\(Q\)</span> from ùïä is an edge of the convex hull,
if all other points lie to the left of <span class="math">\(PQ\)</span>.</div><div class="paragraph">For two arbitrary points <span class="math">\(P\)</span> and <span class="math">\(Q\)</span> from ùïä, we can thus test whether <span class="math">\(PQ\)</span> is
an edge, by determining whether all other points <span class="math">\(R\)</span> lie to the left of <span class="math">\(PQ\)</span>.</div><div class="paragraph"><span class="sidenote">Remember that <p class="from_scribble"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%29%29" class="RktStxLink Sq" data-pltdoc="x">for*</a></span></p> is a nested loop.
The loop looks on all pairs of points <span class="math">\((P,Q)\)</span>.</span>
A brute force algorithm looks like this:

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">metapict</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/set</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">slow-edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink Sq" data-pltdoc="x">for*/list</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-edge-of-convex-hull?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-edge-of-convex-hull?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._equal~3f%29%29" class="RktValLink Sq" data-pltdoc="x">equal?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-lie-to-the-left?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph"><span class="sidenote">The sign of the determinant of the vector pair  <span class="math">\((\overrightarrow{a}, \overrightarrow{b})\)</span>
has the same sign as the orientation from <span class="math">\(\overrightarrow{a}\)</span> to <span class="math">\(\overrightarrow{b}\)</span>.</span>
To implement this algorithm, we need a way to test whether a point <span class="math">\(R\)</span> lies
to the left of the edge <span class="math">\(PQ\)</span>. We could compute the angle
between <span class="math">\(\overrightarrow{PQ}\)</span> and <span class="math">\(\overrightarrow{PR}\)</span>, but it is faster to compute their determinant.

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-of?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PQ</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._pt-%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt-</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PR</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._pt-%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt-</a></span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._positive~3f%29%29" class="RktValLink Sq" data-pltdoc="x">positive?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">vec-det</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">PQ</span><span class="hspace">&nbsp;</span><span class="RktSym">PR</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">left-of?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#t</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">left-of?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#f</span></p></td></tr></table></blockquote></div><div class="paragraph">Defining <p class="from_scribble"><span class="RktSym">all-lie-to-the-left?</span></p> is now simple.</div><div class="paragraph"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-lie-to-the-left?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Fand%29%29" class="RktStxLink Sq" data-pltdoc="x">for/and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-subtract%29%29" class="RktValLink Sq" data-pltdoc="x">set-subtract</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set%29%29" class="RktValLink Sq" data-pltdoc="x">set</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-of?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph"><span class="sidenote">The function <p class="from_scribble"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._random%29%29" class="RktValLink Sq" data-pltdoc="x">random</a></span></p> generates a random number between 0 and 1.</span>
We are now ready to test our algorithm. Let&rsquo;s write a function
that generates <p class="from_scribble"><span class="RktSym">n</span></p> random points in a rectangular window.
We allow the user to set a seed, so a test case can be reproduced.</div><div class="paragraph"><span class="sidenote">The <p class="from_scribble"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink Sq" data-pltdoc="x">_</a></span></p> in the <p class="from_scribble"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink Sq" data-pltdoc="x">for</a></span></p>-clause indicates that we ignore
the values looped over (here the numbers <span class="math">\(0, 1, \ldots, \)</span>n-1<span class="math">\().\)</span></span>
<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">from</span><span class="hspace">&nbsp;</span><span class="RktSym">to</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink Sq" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">from</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink Sq" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">to</span><span class="hspace">&nbsp;</span><span class="RktSym">from</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._random%29%29" class="RktValLink Sq" data-pltdoc="x">random</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">random-points</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">win</span><span class="hspace">&nbsp;</span><span class="RktPn">#:seed</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink Sq" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._random-seed%29%29" class="RktValLink Sq" data-pltdoc="x">random-seed</a></span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match-define%29%29" class="RktStxLink Sq" data-pltdoc="x">defm</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._window%2529%2529" class="RktValLink Sq" data-pltdoc="x">window</a></span><span class="hspace">&nbsp;</span><span class="RktSym">xmin</span><span class="hspace">&nbsp;</span><span class="RktSym">xmax</span><span class="hspace">&nbsp;</span><span class="RktSym">ymin</span><span class="hspace">&nbsp;</span><span class="RktSym">ymax</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">win</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28form._%28%28lib._racket%2Fset..rkt%29._for%2Fset%29%29" class="RktStxLink Sq" data-pltdoc="x">for/set</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">xmin</span><span class="hspace">&nbsp;</span><span class="RktSym">xmax</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rand</span><span class="hspace">&nbsp;</span><span class="RktSym">ymin</span><span class="hspace">&nbsp;</span><span class="RktSym">ymax</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">default-example</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">random-points</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._window%2529%2529" class="RktValLink Sq" data-pltdoc="x">window</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>5.0</span><span class="hspace">&nbsp;</span><span class="RktVal">15.0</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-9</span>.0</span><span class="hspace">&nbsp;</span><span class="RktVal">9.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:seed</span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph">To see the result, we must draw both the points and the edges.
<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">red</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fcolor..rkt%2529._color-med%2529%2529" class="RktValLink Sq" data-pltdoc="x">color-med</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.2</span><span class="hspace">&nbsp;</span><span class="RktVal">&quot;red&quot;</span><span class="hspace">&nbsp;</span><span class="RktVal">&quot;black&quot;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">#:size</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">size</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpict..rkt%2529._penwidth%2529%2529" class="RktValLink Sq" data-pltdoc="x">penwidth</a></span><span class="hspace">&nbsp;</span><span class="RktSym">size</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fcolor..rkt%2529._color%2529%2529" class="RktValLink Sq" data-pltdoc="x">color</a></span><span class="hspace">&nbsp;</span><span class="RktSym">red</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-~3elist%29%29" class="RktValLink Sq" data-pltdoc="x">set-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;</span><span class="RktSym">edges</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528form._%2528%2528lib._metapict%252Fdraw..rkt%2529._for%252Fdraw%2529%2529" class="RktStxLink Sq" data-pltdoc="x">for/draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><span class="badlink"><span class="RktValLink">edge</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">edges</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match-define%29%29" class="RktStxLink Sq" data-pltdoc="x">defm</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">from</span><span class="hspace">&nbsp;</span><span class="RktSym">to</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">edge</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fcurve..rkt%2529._curve%2529%2529" class="RktValLink Sq" data-pltdoc="x">curve</a></span><span class="hspace">&nbsp;</span><span class="RktSym">from</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fcurve..rkt%2529._--%2529%2529" class="RktValLink Sq" data-pltdoc="x"><span class="nobreak">--</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">to</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph">All we need now is to setup our drawing window and generate a test case.</div><div class="paragraph"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._set-curve-pict-size%2529%2529" class="RktValLink Sq" data-pltdoc="x">set-curve-pict-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">400</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._curve-pict-window%2529%2529" class="RktValLink Sq" data-pltdoc="x">curve-pict-window</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._window%2529%2529" class="RktValLink Sq" data-pltdoc="x">window</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span>0.1</span><span class="hspace">&nbsp;</span><span class="RktVal">20.1</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0.1</span><span class="hspace">&nbsp;</span><span class="RktVal">10.1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">default-example</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">slow-edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_40.svg" type="image/svg+xml" /></p></td></tr></table></blockquote></div><div class="paragraph">Looks great. There is however a case we did not consider
in <p class="from_scribble"><span class="RktPn">(</span><span class="RktSym">all-lie-to-the-left?</span><span class="stt"> </span><span class="RktSym">P</span><span class="stt"> </span><span class="RktSym">Q</span><span class="stt"> </span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></p>. If <span class="math">\(R\)</span> is a point
on the extension of the line segment between <span class="math">\(P\)</span> and <span class="math">\(Q\)</span>,
then <span class="math">\(R\)</span> is not to the left of the line segment - but <span class="math">\(PQ\)</span>
is still an edge. If however <span class="math">\(R\)</span> lies directly on the line segment <span class="math">\(PQ\)</span>,
then <span class="math">\(PQ\)</span> is not an edge (chances are that <span class="math">\(PR\)</span> and <span class="math">\(RQ\)</span> are edges).

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-edge-of-convex-hull?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._equal~3f%29%29" class="RktValLink Sq" data-pltdoc="x">equal?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Fand%29%29" class="RktStxLink Sq" data-pltdoc="x">for/and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-subtract%29%29" class="RktValLink Sq" data-pltdoc="x">set-subtract</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set%29%29" class="RktValLink Sq" data-pltdoc="x">set</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._or%29%29" class="RktStxLink Sq" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-of?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">collinear?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">on-segment?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">collinear?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PQ</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._pt-%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt-</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PR</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._pt-%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt-</a></span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._zero~3f%29%29" class="RktValLink Sq" data-pltdoc="x">zero?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">vec-det</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">PQ</span><span class="hspace">&nbsp;</span><span class="RktSym">PR</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">on-segment?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._dist%2529%2529" class="RktValLink Sq" data-pltdoc="x">dist</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._dist%2529%2529" class="RktValLink Sq" data-pltdoc="x">dist</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpt-vec..rkt%2529._dist%2529%2529" class="RktValLink Sq" data-pltdoc="x">dist</a></span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">R</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph">A quick test:

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._set-curve-pict-size%2529%2529" class="RktValLink Sq" data-pltdoc="x">set-curve-pict-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktVal">70</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._curve-pict-window%2529%2529" class="RktValLink Sq" data-pltdoc="x">curve-pict-window</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._window%2529%2529" class="RktValLink Sq" data-pltdoc="x">window</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0.1</span><span class="hspace">&nbsp;</span><span class="RktVal">10.1</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.1</span><span class="hspace">&nbsp;</span><span class="RktVal">6.1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set%29%29" class="RktValLink Sq" data-pltdoc="x">set</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">slow-edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_41.svg" type="image/svg+xml" /></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._length%29%29" class="RktValLink Sq" data-pltdoc="x">length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">slow-edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">6</span></p></td></tr></table></blockquote></div><div class="paragraph">The running time of <p class="from_scribble"><span class="RktSym">slow-edges-of-convex-hull</span></p> is <span class="math">\(O(n^3)\)</span>.
In the next section, we will improve this.

</div><a name="7.2"></a><div class="subsection">7.2  Convex Hull - An incremental algorithm</div><div class="paragraph">This time we will find the edges of the convex hull polygon
in order. If we sort the points of <span class="math">\(ùïä=\{P_1,P_2,\ldots,P_n\}\)</span>,
after their <span class="math">\(x\)</span>-coordinate (and break ties with the <span class="math">\(y\)</span>-coordinate),
then the left-most point must be a vertex of the polygon.</div><div class="paragraph">We will then add one point at a time until we get to the right-most point.
Given a vertex point <span class="math">\(P\)</span>, we will thus test the following points <span class="math">\(Q\)</span> in turn
until we find an edge <span class="math">\(PQ\)</span>. This will give us the lower half of the convex hull.</div><div class="paragraph">First, functions to sort the points.

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/list</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">pt&lt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match-define%29%29" class="RktStxLink Sq" data-pltdoc="x">defm</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._px%2529%2529" class="RktValLink Sq" data-pltdoc="x">px</a></span><span class="hspace">&nbsp;</span><span class="RktSym">py</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match-define%29%29" class="RktStxLink Sq" data-pltdoc="x">defm</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._pt%2529%2529" class="RktValLink Sq" data-pltdoc="x">pt</a></span><span class="hspace">&nbsp;</span><span class="RktSym">qx</span><span class="hspace">&nbsp;</span><span class="RktSym">qy</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._or%29%29" class="RktStxLink Sq" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._px%2529%2529" class="RktValLink Sq" data-pltdoc="x">px</a></span><span class="hspace">&nbsp;</span><span class="RktSym">qx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._px%2529%2529" class="RktValLink Sq" data-pltdoc="x">px</a></span><span class="hspace">&nbsp;</span><span class="RktSym">qx</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">py</span><span class="hspace">&nbsp;</span><span class="RktSym">qy</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sort-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktSym">compare</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._sort%29%29" class="RktValLink Sq" data-pltdoc="x">sort</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-~3elist%29%29" class="RktValLink Sq" data-pltdoc="x">set-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">compare</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph">For each point <span class="math">\(P\)</span> we want to look at the following points.
A little helper function makes the main loop easier to read.</div><div class="paragraph"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rests</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink Sq" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty?</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink Sq" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rest</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rests</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rest</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">rests</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'((2 3 4) (3 4) (4) ())</span></p></td></tr></table></blockquote></div><div class="paragraph">Now we can define our main function:</div><div class="paragraph"><span class="sidenote">The expression <br /> <p class="from_scribble"><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink Sq" data-pltdoc="x">filter</a></span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/values.html#%28def._%28%28quote._~23~25kernel%29._values%29%29" class="RktValLink Sq" data-pltdoc="x">values</a></span><span class="stt"> </span><span class="RktSym">xs</span><span class="RktPn">)</span></p> <br /> filters out any <p class="from_scribble"><span class="RktVal">#f</span></p> from the list <p class="from_scribble"><span class="RktSym">xs</span></p>.</span>
<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-lower-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-edge-from</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2For%29%29" class="RktStxLink Sq" data-pltdoc="x">for/or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink Sq" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-edge-of-convex-hull?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sort-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">pt&lt;</span></span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink Sq" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/values.html#%28def._%28%28quote._~23~25kernel%29._values%29%29" class="RktValLink Sq" data-pltdoc="x">values</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">P</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">sorted</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">Qs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rests</span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-edge-from</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph">We better check that it works as expected. To do that we
first extend <p class="from_scribble"><span class="RktSym">draw-points</span></p> to optionally label
our points.

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/format</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">ps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:size</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">size</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">#:label?</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Flabel..rkt%2529._label%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">label?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528form._%2528%2528lib._metapict%252Fdraw..rkt%2529._for%252Fdraw%2529%2529" class="RktStxLink Sq" data-pltdoc="x">for/draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">ps</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-naturals%29%29" class="RktValLink Sq" data-pltdoc="x">in-naturals</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fpict..rkt%2529._penwidth%2529%2529" class="RktValLink Sq" data-pltdoc="x">penwidth</a></span><span class="hspace">&nbsp;</span><span class="RktSym">size</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fcolor..rkt%2529._color%2529%2529" class="RktValLink Sq" data-pltdoc="x">color</a></span><span class="hspace">&nbsp;</span><span class="RktSym">red</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Flabel..rkt%2529._label%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">label?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Flabel..rkt%2529._label-rt%2529%2529" class="RktValLink Sq" data-pltdoc="x">label-rt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#%28def._%28%28lib._racket%2Fformat..rkt%29._~7ea%29%29" class="RktValLink Sq" data-pltdoc="x">~a</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="paragraph"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._set-curve-pict-size%2529%2529" class="RktValLink Sq" data-pltdoc="x">set-curve-pict-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">400</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdevice..rkt%2529._curve-pict-window%2529%2529" class="RktValLink Sq" data-pltdoc="x">curve-pict-window</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fstructs..rkt%2529._window%2529%2529" class="RktValLink Sq" data-pltdoc="x">window</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span>0.1</span><span class="hspace">&nbsp;</span><span class="RktVal">20.1</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0.1</span><span class="hspace">&nbsp;</span><span class="RktVal">10.1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">default-example</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._sort%29%29" class="RktValLink Sq" data-pltdoc="x">sort</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-~3elist%29%29" class="RktValLink Sq" data-pltdoc="x">set-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">pt&lt;</span></span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-lower-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">#:label?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_42.svg" type="image/svg+xml" /></p></td></tr></table></blockquote></div><div class="paragraph">We can now define the corresponding function to find the upper hull.</div><div class="paragraph"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pt&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">pt&lt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-upper-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-edge-from</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2For%29%29" class="RktStxLink Sq" data-pltdoc="x">for/or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink Sq" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">is-edge-of-convex-hull?</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Q</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sort-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="hspace">&nbsp;</span><span class="RktSym">pt&gt;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink Sq" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/values.html#%28def._%28%28quote._~23~25kernel%29._values%29%29" class="RktValLink Sq" data-pltdoc="x">values</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">P</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">sorted</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">Qs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rests</span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-edge-from</span><span class="hspace">&nbsp;</span><span class="RktSym">P</span><span class="hspace">&nbsp;</span><span class="RktSym">Qs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote>

And the upper hull of our running examples looks like this:

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">def</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._sort%29%29" class="RktValLink Sq" data-pltdoc="x">sort</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sets.html#%28def._%28%28lib._racket%2Fset..rkt%29._set-~3elist%29%29" class="RktValLink Sq" data-pltdoc="x">set-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">pt&gt;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-upper-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">sorted</span><span class="hspace">&nbsp;</span><span class="RktPn">#:label?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_43.svg" type="image/svg+xml" /></p></td></tr></table></blockquote></div><div class="paragraph">Combining the two functions, we get:

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._append%29%29" class="RktValLink Sq" data-pltdoc="x">append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-lower-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-upper-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote>

And the example looks like this:

<blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=metapict&amp;rel=index.html%23%2528def._%2528%2528lib._metapict%252Fdraw..rkt%2529._draw%2529%2529" class="RktValLink Sq" data-pltdoc="x">draw</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-edges</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">edges-of-convex-hull</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-points</span><span class="hspace">&nbsp;</span><span class="RktSym">&#120138;</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_44.svg" type="image/svg+xml" /></p></td></tr></table></blockquote>
</div>
   </div>
 </div>
 <script id="MathJax-script" async
       src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg-full.js">
 </script>
 </body>
 </html>
